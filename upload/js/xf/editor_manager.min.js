var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(b,e,c){b instanceof String&&(b=String(b));for(var f=b.length,a=0;a<f;a++){var d=b[a];if(e.call(c,d,a,b))return{i:a,v:d}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,e,c){b!=Array.prototype&&b!=Object.prototype&&(b[e]=c.value)};
$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(b,e,c,f){if(e){c=$jscomp.global;b=b.split(".");for(f=0;f<b.length-1;f++){var a=b[f];a in c||(c[a]={});c=c[a]}b=b[b.length-1];f=c[b];e=e(f);e!=f&&null!=e&&$jscomp.defineProperty(c,b,{configurable:!0,writable:!0,value:e})}};
$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(b,c){return $jscomp.findInternal(this,b,c).v}},"es6","es3");
!function(b,e,c,f){XF.EditorManager=XF.Element.newHandler({options:{dragListClass:".js-dragList",commandTrayClass:".js-dragList-commandTray"},$lists:null,trayElements:[],listElements:[],isScrollable:!0,dragula:null,init:function(){this.$lists=this.$target.find(this.options.dragListClass);this.$lists.each(XF.proxy(this,"prepareList"));this.initDragula()},prepareList:function(a,d){b(d).is(this.options.commandTrayClass)?this.trayElements.push(d):this.listElements.push(d);this.rebuildValueCache(d)},initDragula:function(){var a=
this;c.addEventListener("touchmove",function(b){a.isScrollable||b.preventDefault()},{passive:!1});var d=this.listElements,g;for(g in this.trayElements)d.unshift(this.trayElements[g]);this.dragula=dragula(d,{direction:"horizontal",removeOnSpill:!0,copy:function(b,d){return a.isTrayElement(d)},accepts:function(b,d){return!a.isTrayElement(d)},moves:function(a,d,g,c){return!b(a).hasClass("toolbar-addDropdown")&&!b(a).hasClass("fr-separator")}});this.dragula.on("drag",XF.proxy(this,"drag"));this.dragula.on("dragend",
XF.proxy(this,"dragend"));this.dragula.on("drop",XF.proxy(this,"drop"));this.dragula.on("cancel",XF.proxy(this,"cancel"));this.dragula.on("remove",XF.proxy(this,"remove"));this.dragula.on("over",XF.proxy(this,"over"));this.dragula.on("out",XF.proxy(this,"out"))},drag:function(a,d){this.isScrollable=!1;a=b(a);d=b(d);a.hasClass("toolbar-separator")&&!d.hasClass("js-dragList-commandTray")&&a.next(".fr-separator").remove()},dragend:function(a){this.isScrollable=!0;b(".js-dropTarget").remove()},drop:function(a,
d,g,c){a=b(a);c=b(d);var e=a.data("cmd");1<c.find('[data-cmd="'+e+'"]').length&&!a.hasClass("toolbar-separator")&&(a.remove(),XF.flashMessage(XF.phrase("buttons_menus_may_not_be_duplicated"),1500));a.hasClass("toolbar-separator")?this.appendSeparator(a):a.next().is(".fr-separator")&&a.insertAfter(a.next());"menu"===a.attr("data-xf-click")&&a.attr("data-xf-click",null);this.isTrayElement(g)||this.rebuildValueCache(g);this.isTrayElement(d)||this.rebuildValueCache(d)},cancel:function(a,d,c){a=b(a);c=
b(c);a.hasClass("toolbar-separator")&&!c.hasClass("js-dragList-commandTray")&&this.appendSeparator(a)},remove:function(a,b,c){this.isTrayElement(c)||(XF.flashMessage(XF.phrase("button_removed"),1500),this.rebuildValueCache(c))},over:function(a,b,c){},out:function(a,b,c){},rebuildValueCache:function(a){a=b(a);var c=a.find(".js-dragListValue"),e=[];c.length&&(a.children().each(function(a,c){a=b(c);a.data("cmd")&&e.push(a.data("cmd"))}),c.val(JSON.stringify(e)))},appendSeparator:function(a){b("<div />").addClass("fr-separator").addClass("fr"+
a.data("cmd")).insertAfter(a)},isTrayElement:function(a){return-1!==this.trayElements.indexOf(a)}});XF.Element.register("editor-manager","XF.EditorManager")}(jQuery,window,document);
