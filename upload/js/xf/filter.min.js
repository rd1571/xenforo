var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(b,f,d){b instanceof String&&(b=String(b));for(var e=b.length,a=0;a<e;a++){var c=b[a];if(f.call(d,c,a,b))return{i:a,v:c}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,f,d){b!=Array.prototype&&b!=Object.prototype&&(b[f]=d.value)};
$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(b,f,d,e){if(f){d=$jscomp.global;b=b.split(".");for(e=0;e<b.length-1;e++){var a=b[e];a in d||(d[a]={});d=d[a]}b=b[b.length-1];e=d[b];f=f(e);f!=e&&null!=f&&$jscomp.defineProperty(d,b,{configurable:!0,writable:!0,value:f})}};
$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(b,d){return $jscomp.findInternal(this,b,d).v}},"es6","es3");
!function(b,f,d,e){XF.Filter=XF.Element.newHandler({options:{inputEl:"| .js-filterInput",prefixEl:"| .js-filterPrefix",clearEl:"| .js-filterClear",countEl:".js-filterCount",totalsEl:".js-displayTotals",searchTarget:null,searchRow:null,searchRowGroup:null,searchLimit:"",key:"",ajax:null,noResultsFormat:'<div class="js-filterNoResults">%s</div>'},storageContainer:"filter",storageCutOff:3600,storageKey:null,$input:null,$prefix:null,$clear:null,$count:null,$displayTotals:null,$search:null,$noResults:null,
$ajaxRows:null,updateTimer:null,xhr:null,xhrFilter:null,init:function(){var a=this.$target;this.options.searchTarget&&(this.$search=XF.findRelativeIf(this.options.searchTarget,a));this.$search&&this.$search.length||(this.$search=a.next());this.$search&&this.$search.length||(this.$search=a.findExtended("< .block | .dataList"));this.$search.is(".dataList")&&!this.options.searchRow&&(this.options.searchRow=".dataList-row:not(.dataList-row--header):not(.dataList-row--subSection):not(.dataList-row--footer)",
this.options.searchRowGroup=".dataList-rowGroup",this.options.searchLimit=".dataList-cell:not(.dataList-cell--action):not(.dataList-cell--noSearch)",this.options.noResultsFormat='<tbody><tr class="js-filterNoResults dataList-row dataList-row--note dataList-row--noHover is-hidden"><td class="dataList-cell" colspan="50">%s</td></tr></tbody>');this.$input=XF.findRelativeIf(this.options.inputEl,a);this.$prefix=XF.findRelativeIf(this.options.prefixEl,a);this.$clear=XF.findRelativeIf(this.options.clearEl,
a);this.$count=XF.findRelativeIf(this.options.countEl,a.closest("form, .block"));this.$displayTotals=XF.findRelativeIf(this.options.totalsEl,a.closest("form",".block"));this.$input.on({keyup:XF.proxy(this,"onKeyUp"),keypress:XF.proxy(this,"onKeyPress"),paste:XF.proxy(this,"onPaste")});this.$prefix.on("change",XF.proxy(this,"onPrefixChange"));this.$clear.on("click",XF.proxy(this,"onClearFilter"));this.storageKey=this.options.key;this.storageKey.length||(a=a.closest("form"),a.length&&(this.storageKey=
a.attr("action")));if(a=this._getStoredValue())this.$input.val(a.filter),this.$prefix.prop("checked",a.prefix);this.$input.val().length&&this.update();this._cleanUpStorage()},onKeyUp:function(a){if(!a.ctrlKey&&!a.metaKey){switch(a.key){case "Tab":case "Enter":case "Shift":case "Control":case "Alt":break;default:this.planUpdate()}"Enter"!=a.key&&this.planUpdate()}},onKeyPress:function(a){"Enter"==a.key&&(a.preventDefault(),this.update())},onPaste:function(a){this.planUpdate()},onPrefixChange:function(a){this.update()},
onClearFilter:function(a){this.$clear.is(".is-disabled")||(this.$input.val(""),this.$prefix.prop("checked",!1),this.update())},planUpdate:function(){this.updateTimer&&clearTimeout(this.updateTimer);this.updateTimer=setTimeout(XF.proxy(this,"update"),250)},update:function(){this.updateTimer&&clearTimeout(this.updateTimer);this.filter(this.$input.val(),this.$prefix.is(":checked")?!0:!1)},_getSearchRows:function(a){a||(a=this.$search);a=a.find(this.options.searchRow);this.$noResults&&(a=a.not(this.$noResults));
return a},filter:function(a,c){this._updateStoredValue(a,c);this._toggleFilterHide(0<a.length);this.options.ajax?this._filterAjax(a,c):(a=this._applyFilter(this._getSearchRows(),a,c),this._toggleNoResults(0==a))},_filterAjax:function(a,c){this.xhr&&(this.xhr.abort(),this.xhr=null);if(a.length){var b={_xfFilter:{text:a,prefix:c?1:0}};this.xhrFilter={text:a,prefix:c};this.xhr=XF.ajax("GET",this.options.ajax,b,XF.proxy(this,"_filterAjaxResponse"))}else this._clearAjaxRows(),a=this._applyFilter(this._getSearchRows(),
a,c),this._toggleNoResults(0==a)},_filterAjaxResponse:function(a){this.xhr=null;this._clearAjaxRows();a=b(b.parseHTML(a.html.content)).find(this.options.searchRow);var c=this.xhrFilter;this._getSearchRows().addClass("is-hidden");this._applyRowGroupLimit();this._toggleNoResults(0==a.length);a.length?(this._appendRows(a),XF.activate(a),this.$ajaxRows=a,this._applyFilter(a,c.text,c.prefix)):XF.layoutChange();this.xhrFilter=null},_applyFilter:function(a,c,g){var h=this.options.searchLimit,d=0,f=this;
if(c.length){var e=new RegExp((g?"^":"")+"("+XF.regexQuote(c)+")","i");var k=new RegExp((g?"^":"")+"("+XF.regexQuote(XF.htmlspecialchars(c))+")","ig")}else k=e=!1;a.each(function(){var a=b(this),c=!1,g=h?a.find(h):a;g.find(".is-match").each(function(){var a=this.parentNode;b(this).replaceWith(this.childNodes);a.normalize()});!e||a.hasClass("js-filterForceShow")?c=!0:g.each(function(){f._searchFilter(this,e,k)&&(c=!0)});c?(a.removeClass("is-hidden"),a.hasClass("js-filterForceShow")||d++):a.addClass("is-hidden")});
this._applyRowGroupLimit(0==c.length);this.updateDisplayTotals(d);XF.layoutChange();return d},_applyRowGroupLimit:function(a){var c=this.options.searchRowGroup,g=this.options.searchRow;c&&this.$search.find(c).each(function(){var c=b(this),d=c.find(g).filter(":not(.is-hidden)");a||d.length?c.removeClass("is-hidden"):c.addClass("is-hidden")})},_searchFilter:function(a,c,g){var d=!1;if(3==a.nodeType)c.test(a.data)&&(d=!0,c=XF.htmlspecialchars(a.data).replace(g,'<span class="is-match">$1</span>'),b(a).replaceWith(b.parseHTML(c)));
else{a=a.childNodes;for(var e=a.length-1;0<=e;e--)this._searchFilter(a[e],c,g)&&(d=!0)}return d},_clearAjaxRows:function(){this.$ajaxRows&&(this.$ajaxRows.remove(),this.$ajaxRows=null)},_toggleFilterHide:function(a){this.$clear.toggleClass("is-disabled",!a);b(".js-filterHide").css("display",a?"none":"")},_toggleNoResults:function(a){a?(this.getNoResultsRow().removeClass("is-hidden"),this.updateDisplayTotals(0)):this.$noResults&&this.$noResults.addClass("is-hidden")},updateDisplayTotals:function(a){this.$count.text(a);
if(this.$displayTotals.length){this.$displayTotals.data("count",a);var c=this.$displayTotals.data("total");this.$displayTotals.text(XF.stringTranslate(1>a?XF.phrases.no_items_to_display:a==c?XF.phrases.showing_all_items:XF.phrases.showing_x_of_y_items,{"{count}":a.toLocaleString(),"{total}":c.toLocaleString()}))}},getNoResultsRow:function(){if(this.$noResults)return this.$noResults;var a=this.options.noResultsFormat.replace("%s",XF.phrase("no_items_matched_your_filter"));a=this.$noResults=b(b.parseHTML(a));
this._appendRows(a);a.is(".js-filterNoResults")?this.$noResults=a:this.$noResults=a.find(".js-filterNoResults");return this.$noResults},_appendRows:function(a){var c=this.$search.find(this.options.searchRow).last(),b=null,d=this.options.searchRowGroup;c.closest(this.options.searchRowGroup+", tbody");d&&(b=c.closest(d),b.length||(b=null));!b&&c.is("tr")&&(b=c.closest("tbody"),b.length||(b=null));b||(b=c);b.length?a.insertAfter(b):a.appendTo(this.$search)},_getStoredValue:function(){if(!this.storageKey)return null;
var a=this._readFromStorage();if(a[this.storageKey]){a=a[this.storageKey];var b=a.saved||0,d=Math.floor((new Date).getTime()/1E3);if(b+this.storageCutOff>=d)return{filter:a.filter||"",prefix:a.prefix||!1}}return null},_updateStoredValue:function(a,b){if(this.storageKey){var c=this._readFromStorage();a.length?c[this.storageKey]={filter:a,prefix:b?!0:!1,saved:Math.floor((new Date).getTime()/1E3)}:c[this.storageKey]&&delete c[this.storageKey];this._writeToStorage(c)}},_cleanUpStorage:function(){if(this.storageKey){var a=
this._readFromStorage(),b=!1,d=Math.floor((new Date).getTime()/1E3)-this.storageCutOff,e;for(e in a)a.hasOwnProperty(e)&&(a[e].saved||0)<d&&(delete a[e],b=!0);b&&this._writeToStorage(a)}},_readFromStorage:function(){return XF.LocalStorage.getJson(this.storageContainer)},_writeToStorage:function(a){b.isEmptyObject(a)?XF.LocalStorage.remove(this.storageContainer):XF.LocalStorage.setJson(this.storageContainer,a,!0)}});XF.PrefixGrabber=XF.Event.newHandler({eventNameSpace:"XFPrefixGrabberClick",options:{filterElement:"[data-xf-init~=filter]"},
filterHandler:null,init:function(){this.filterHandler=XF.Element.getHandler(b(this.options.filterElement),"filter");if(!this.filterHandler instanceof XF.Filter)return console.warn("PrefixGrabber did not find an element with an XF.Filter handler"),!1},click:function(a){if(this.filterHandler.$prefix.is(":checked")&&(a=this.filterHandler.$input.val(),a.length)){var b=this.$target.attr("href");b=b+(-1==b.indexOf("?")?"?":"&")+"prefix="+a;this.$target.attr("href",b)}}});XF.Element.register("filter","XF.Filter");
XF.Event.register("click","prefix-grabber","XF.PrefixGrabber")}(jQuery,window,document);
